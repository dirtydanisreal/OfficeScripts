{"version":"0.3.0","body":"function main(workbook: ExcelScript.Workbook) {\n  let sheet = workbook.getActiveWorksheet();\n  const protection = sheet.getProtection();\n\n  // Temporarily pause protection with the password\n  protection.pauseProtection(\"imsorrydave\");\n\n  // Define the necessary sheets and ranges\n  let listSheet = workbook.getWorksheet(\"RN-NCT LIST\");\n  let psSheet = workbook.getWorksheet(\"PHONE 7.200 ICU\");\n  let numbersRange = listSheet.getRange(\"A2:D900\");\n  let values = numbersRange.getValues();\n\n  listSheet.getProtection().pauseProtection(\"imsorrydave\");\n\n  // Find the last used row in the range\n  let lastUsedRow = findLastUsedRow(values);\n  console.log(`Last used row: ${lastUsedRow}`);\n\n  // Get values from PHONE 6.100 AC-PC sheet (L3, L4, L5)\n  const first = psSheet.getRange(\"Q5\").getValue().toString().toUpperCase().trim();\n  const last = psSheet.getRange(\"Q6\").getValue().toString().toUpperCase().trim();\n  const num = psSheet.getRange(\"Q7\").getValue().toString().toUpperCase().trim();\n  console.log(`Values to insert: ${first}, ${last}, ${num}`);\n\n  // Insert values into RN-NCT LIST sheet at the next available row\n  // Note: Using getRangeByIndexes() to set a range with multiple columns\n  try {\n    listSheet.getRangeByIndexes(lastUsedRow, 0, 1, 4).setValues([[first, last, null, num]]);\n  } catch (error) {\n    console.log(`Error setting values: ${JSON.stringify(error)}`);\n  }\n\n  // Remove duplicates from columns A, B, and D\n  numbersRange.removeDuplicates([0, 1, 3], false);\n\n  // Clear contents of L3, L4, and L5 in PHONE 6.100 AC-PC sheet\n  psSheet.getRange(\"Q5:Q7\").clear(ExcelScript.ClearApplyTo.contents);\n\n  // Resume protection\n  protection.resumeProtection();\n  listSheet.getProtection().resumeProtection();\n}\n\n// Helper function to find the last used row in the range\nfunction findLastUsedRow(values: (string | number | boolean)[][]): number {\n  for (let row = values.length - 1; row >= 0; row--) {\n    if (!values[row].every(cell => cell === null || cell === '')) {\n      return row + 1; // Return the last used row (1-based index)\n    }\n  }\n  return 0; // Return 0 if no rows are used\n}","description":"","noCodeMetadata":"","parameterInfo":"{\"version\":1,\"originalParameterOrder\":[],\"parameterSchema\":{\"type\":\"object\",\"default\":{},\"x-ms-visibility\":\"internal\"},\"returnSchema\":{\"type\":\"object\",\"properties\":{}},\"signature\":{\"comment\":\"\",\"parameters\":[{\"name\":\"workbook\",\"comment\":\"\"}]}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}