{"version":"0.3.0","body":"\nfunction main(workbook: ExcelScript.Workbook) {\n  \n  let sheet = workbook.getActiveWorksheet();\n\n  const protection: ExcelScript.WorksheetProtection = sheet.getProtection();\n\n  \n\n  protection.pauseProtection(\"imsorrydave\");\n\n  let list = workbook.getWorksheet(\"RN-NCT LIST\");\n\n  let ps = workbook.getWorksheet(\"31-42\");\n\n  let numbers = list.getRange(\"A1:D500\");\n\n  let values = numbers.getValues();\n\n  // Initialize variable to store the last used row\n  let lastUsedRow = 0;\n\n  // Iterate over each row in the range\n  for (let row = values.length - 1; row >= 0; row--) {\n    // Check if the current row contains any non-empty cells\n    let isRowEmpty = values[row].every(cell => cell === null || cell === '');\n\n    if (!isRowEmpty) {\n      // If the row is not empty, update lastUsedRow\n      lastUsedRow = row + 1; // ExcelScript rows are 1-based\n      break;\n    }\n  }\n\n  const first = ps.getRange(\"L3\").getValue();\n\n  const last = ps.getRange(\"L4\").getValue();\n\n  const num = ps.getRange(\"L5\").getValue();\n\n  list.getCell(lastUsedRow + 1, 0).setValue(first);\n\n  list.getCell(lastUsedRow + 1, 1).setValue(last);\n\n  list.getCell(lastUsedRow + 1, 3).setValue(num);\n\n  numbers.removeDuplicates([0,1,3],false);\n  \n    protection.resumeProtection();\n}\n\n","description":"","noCodeMetadata":null,"parameterInfo":"{\"version\":1,\"originalParameterOrder\":[],\"parameterSchema\":{\"type\":\"object\",\"default\":{},\"x-ms-visibility\":\"internal\"},\"returnSchema\":{\"type\":\"object\",\"properties\":{}},\"signature\":{\"comment\":\"\",\"parameters\":[{\"name\":\"workbook\",\"comment\":\"\"}]}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}