{"version":"0.3.0","body":"function main(workbook: ExcelScript.Workbook) {\n    let sheet = workbook.getActiveWorksheet();\n    const protection = sheet.getProtection();\n\n    // Temporarily pause protection with the password\n    protection.pauseProtection(\"imsorrydave\");\n\n    addName(workbook.getActiveWorksheet(), \"L3\", \"L4\", \"L5\", \"PHONE 6.100 AC-PC\");\n\n    // Clear contents of L3, L4, and L5 in PHONE 6.100 AC-PC sheet\n    sheet.getRange(\"L3:L5\").clear(ExcelScript.ClearApplyTo.contents);\n\n    // Resume protection\n    protection.resumeProtection();\n}\n\n// Helper function to find the last used row in the range\nfunction findLastUsedRow(values: (string | number | boolean)[][]): number {\n    for (let row = values.length - 1; row >= 0; row--) {\n        if (!values[row].every(cell => cell === null || cell === '')) {\n            return row + 1; // Return the last used row (1-based index)\n        }\n    }\n    return 0; // Return 0 if no rows are used\n}\n\n\nfunction addName(worksheet: ExcelScript.Worksheet, firstNameCell: string, lastNameCell: string, numberCell: string, numbersSheet: ExcelScript.Worksheet) {\n    let numbersRange = numbersSheet.getRange(\"A2:D400\");\n    let values = numbersRange.getValues();\n    let lastUsedRow = findLastUsedRow(values);\n\n    const first = worksheet.getRange(firstNameCell).getValue().toString().toUpperCase().trim();\n    const last = worksheet.getRange(lastNameCell).getValue().toString().toUpperCase().trim();\n    const num = worksheet.getRange(numberCell).getValue().toString().toUpperCase().trim();\n\n    worksheet.getRangeByIndexes(lastUsedRow, 0, 1, 4).setValues([[first, last, null, num]]);\n\n    numbersRange.removeDuplicates([0, 1, 3], false);\n}","description":"","noCodeMetadata":"","parameterInfo":"{\"version\":1,\"originalParameterOrder\":[],\"parameterSchema\":{\"type\":\"object\",\"default\":{},\"x-ms-visibility\":\"internal\"},\"returnSchema\":{\"type\":\"object\",\"properties\":{}},\"signature\":{\"comment\":\"\",\"parameters\":[{\"name\":\"workbook\",\"comment\":\"\"}]}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}