{"version":"0.3.0","body":"/*\n * This script creates a dropdown using the range of selected values. The dropdown will be created on a new sheet.\n * This script does not affect any pre-existing data in the workbook.\n */\nfunction main(workbook: ExcelScript.Workbook) {\n  // Get the selected range.\n  const valuesRange = workbook.getSelectedRange();\nlet dropdownCell = workbook.getWorksheet(\"Sheet1\").getRange(\"A1\");\n  const searchRange = workbook.getWorksheet(\"RN-NCT LIST\").getRange(\"F2:F178\");\n  const duplicateRange = workbook.getWorksheet(\"RN-NCT LIST\").getRange(\"H2:H178\");\n\n  // if the worksheet has no edited cells, finish running the script\n  if (valuesRange === undefined) {\n    console.log(`Please select a range before running this script.`);\n    return;\n  }\n\n  const address = valuesRange.getAddress();\n\n  console.log(`Dropdown options coming from range: ${address}`);\n\n  // Insert the dropdown in A1 of a new sheet. You can change this to another cell in the workbook.\n  const newSheet = workbook.addWorksheet();\n  const dropDownTargetRange = newSheet.getRange(\"A1\");\n\n  console.log(address);\n\n  // Equal sign necessary to reference an address.\n  dropDownTargetRange.getDataValidation().setRule({\n    list: { inCellDropDown: true, source: \"=\" + address },\n  });\n\n  console.log(`Inserted dropdown at ${dropDownTargetRange.getAddress()}`);\n  console.log(\n    \"This dropdown can be copied to anywhere else in the workbook.\"\n  );\n\n  newSheet.activate();\n}\n","description":"This script creates a dropdown from selected data. To use this script, select multiple cells in a column. The dropdown will be created on a new sheet, and will have options corresponding to the selected values.","noCodeMetadata":null,"parameterInfo":"{\"version\":1,\"originalParameterOrder\":[],\"parameterSchema\":{\"type\":\"object\",\"default\":{},\"x-ms-visibility\":\"internal\"},\"returnSchema\":{\"type\":\"object\",\"properties\":{}},\"signature\":{\"comment\":\"\",\"parameters\":[{\"name\":\"workbook\",\"comment\":\"\"}]}}","apiInfo":"{\"variant\":\"synchronous\"}"}